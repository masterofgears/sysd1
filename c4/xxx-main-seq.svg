<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1020px" preserveAspectRatio="none" style="width:1955px;height:1020px;background:#FFFFFF;" version="1.1" viewBox="0 0 1955 1020" width="1955px" zoomAndPan="magnify"><defs/><g><rect height="26.2969" id="_title" style="stroke:#00000000;stroke-width:1.0;fill:none;" width="240" x="864" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="230" x="869" y="27.9951">Главный поток выполнения</text><rect fill="#FFEBCD" height="963.8125" style="stroke:#181818;stroke-width:0.5;" width="490" x="16" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="170.5" y="55.3638"> </text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181" x="170.5" y="70.4966">Source External System</text><rect fill="#E0FFFF" height="963.8125" style="stroke:#181818;stroke-width:0.5;" width="693.5" x="633" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="922.25" y="55.3638"> </text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="115" x="922.25" y="70.4966">Airflow System</text><rect fill="#FFF8DC" height="963.8125" style="stroke:#181818;stroke-width:0.5;" width="335" x="1510" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="5" x="1568.5" y="55.3638"> </text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="218" x="1568.5" y="70.4966">Destination External System</text><rect fill="#FFFFFF" height="70.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="56.5" y="149.8594"/><rect fill="#FFFFFF" height="130.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="232.5" y="220.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="418.5" y="321.6563"/><rect fill="#FFFFFF" height="68.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="716.5" y="435.1875"/><rect fill="#FFFFFF" height="116.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="866" y="503.5859"/><rect fill="#FFFFFF" height="116.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1058" y="589.9844"/><rect fill="#FFFFFF" height="81.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1237" y="706.3828"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1586" y="871.4453"/><rect fill="#FFFFFF" height="65.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1777" y="915.7109"/><rect height="264.1953" style="stroke:#000000;stroke-width:1.5;fill:none;" width="705.5" x="627" y="450.1875"/><rect height="193.1953" style="stroke:#000000;stroke-width:1.5;fill:none;" width="602.5" x="1346.5" y="802.9141"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="61" x2="61" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="237" x2="237" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="423" x2="423" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="569" x2="569" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="721" x2="721" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="871" x2="871" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1062.5" x2="1062.5" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1241.5" x2="1241.5" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1413.5" x2="1413.5" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1591" x2="1591" y1="139.8594" y2="1013.1094"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="1782" x2="1782" y1="139.8594" y2="1013.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="20" y="136.5576">Source_DB</text><path d="M43.5,87.5625 C43.5,77.5625 61.5,77.5625 61.5,77.5625 C61.5,77.5625 79.5,77.5625 79.5,87.5625 L79.5,113.5625 C79.5,123.5625 61.5,123.5625 61.5,123.5625 C61.5,123.5625 43.5,123.5625 43.5,113.5625 L43.5,87.5625 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M43.5,87.5625 C43.5,97.5625 61.5,97.5625 61.5,97.5625 C61.5,97.5625 79.5,97.5625 79.5,87.5625 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="198" y="136.5576">Debezium</text><ellipse cx="237.5" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="225.5" x2="249.5" y1="121.5625" y2="121.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151" x="345" y="136.5576">SourceKafkaConnect</text><ellipse cx="423.5" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="419.5,95.5625,425.5,90.5625,423.5,95.5625,425.5,100.5625,419.5,95.5625" style="stroke:#181818;stroke-width:1.0;"/><path d="M517,113.5625 L622,113.5625 C627,113.5625 627,126.7109 627,126.7109 C627,126.7109 627,139.8594 622,139.8594 L517,139.8594 C512,139.8594 512,126.7109 512,126.7109 C512,126.7109 512,113.5625 517,113.5625 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M622,113.5625 C617,113.5625 617,126.7109 617,126.7109 C617,139.8594 622,139.8594 622,139.8594 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="517" y="131.5576">Kafka_Topics</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="163" x="637" y="136.5576">AirflowKafkaConsumer</text><ellipse cx="721.5" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="717.5,95.5625,723.5,90.5625,721.5,95.5625,723.5,100.5625,717.5,95.5625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="816" y="136.5576">FilterOperator</text><ellipse cx="871" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="859" x2="883" y1="121.5625" y2="121.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="1015.5" y="136.5576">AirFlowCode</text><path d="M1042.5,95.5625 L1042.5,119.5625 M1042.5,107.5625 L1059.5,107.5625 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="1071.5" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155" x="1161.5" y="136.5576">AirflowKafkaProducer</text><ellipse cx="1242" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="1238,95.5625,1244,90.5625,1242,95.5625,1244,100.5625,1238,95.5625" style="stroke:#181818;stroke-width:1.0;"/><path d="M1361.5,113.5625 L1466.5,113.5625 C1471.5,113.5625 1471.5,126.7109 1471.5,126.7109 C1471.5,126.7109 1471.5,139.8594 1466.5,139.8594 L1361.5,139.8594 C1356.5,139.8594 1356.5,126.7109 1356.5,126.7109 C1356.5,126.7109 1356.5,113.5625 1361.5,113.5625 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1466.5,113.5625 C1461.5,113.5625 1461.5,126.7109 1461.5,126.7109 C1461.5,139.8594 1466.5,139.8594 1466.5,139.8594 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="1361.5" y="131.5576">Kafka_Topics</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148" x="1514" y="136.5576">SinkKafkaConnector</text><ellipse cx="1591" cy="107.5625" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="1587,95.5625,1593,90.5625,1591,95.5625,1593,100.5625,1587,95.5625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1723" y="136.5576">Destination_DB</text><path d="M1764,87.5625 C1764,77.5625 1782,77.5625 1782,77.5625 C1782,77.5625 1800,77.5625 1800,87.5625 L1800,113.5625 C1800,123.5625 1782,123.5625 1782,123.5625 C1782,123.5625 1764,123.5625 1764,113.5625 L1764,87.5625 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1764,87.5625 C1764,97.5625 1782,97.5625 1782,97.5625 C1782,97.5625 1800,97.5625 1800,87.5625 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#FFFFFF" height="70.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="56.5" y="149.8594"/><rect fill="#FFFFFF" height="130.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="232.5" y="220.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="418.5" y="321.6563"/><rect fill="#FFFFFF" height="68.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="716.5" y="435.1875"/><rect fill="#FFFFFF" height="116.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="866" y="503.5859"/><rect fill="#FFFFFF" height="116.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1058" y="589.9844"/><rect fill="#FFFFFF" height="81.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="1237" y="706.3828"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1586" y="871.4453"/><rect fill="#FFFFFF" height="65.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1777" y="915.7109"/><polygon fill="#181818" points="72.5,216.125,62.5,220.125,72.5,224.125,68.5,220.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="66.5" x2="231.5" y1="220.125" y2="220.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147" x="78.5" y="215.0591">WAL-репликация CDC</text><line style="stroke:#181818;stroke-width:1.0;" x1="242.5" x2="284.5" y1="279.5234" y2="279.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="284.5" x2="284.5" y1="279.5234" y2="292.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="243.5" x2="284.5" y1="292.5234" y2="292.5234"/><polygon fill="#181818" points="253.5,288.5234,243.5,292.5234,253.5,296.5234,249.5,292.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="249.5" y="244.1919">Фильтрация для</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="249.5" y="259.3247">скользящего окна</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="249.5" y="274.4575">на уровне коннектора</text><polygon fill="#181818" points="406.5,317.6563,416.5,321.6563,406.5,325.6563,410.5,321.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="242.5" x2="412.5" y1="321.6563" y2="321.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="249.5" y="316.5903">фильтрованные записи</text><polygon fill="#181818" points="557.5,346.7891,567.5,350.7891,557.5,354.7891,561.5,350.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="423.5" x2="563.5" y1="350.7891" y2="350.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="430.5" y="345.7231">table_x.topics</text><polygon fill="#181818" points="580.5,431.1875,570.5,435.1875,580.5,439.1875,576.5,435.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="574.5" x2="715.5" y1="435.1875" y2="435.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="586.5" y="399.856">чтения таблиц</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="586.5" y="414.9888">table_x.topics</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="586.5" y="430.1216">из топика</text><path d="M627,450.1875 L768,450.1875 L768,457.3203 L758,467.3203 L627,467.3203 L627,450.1875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="264.1953" style="stroke:#000000;stroke-width:1.5;" width="705.5" x="627" y="450.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="642" y="463.2544">Airflow DAG</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="246" x="783" y="462.3979">[запуск DAG Airflow по расписанию]</text><polygon fill="#181818" points="854,499.5859,864,503.5859,854,507.5859,858,503.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="721.5" x2="860" y1="503.5859" y2="503.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="728.5" y="483.3872">отправка данных</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="728.5" y="498.52">на фильтрацию</text><line style="stroke:#181818;stroke-width:1.0;" x1="876" x2="918" y1="547.8516" y2="547.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="918" x2="918" y1="547.8516" y2="560.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="877" x2="918" y1="560.8516" y2="560.8516"/><polygon fill="#181818" points="887,556.8516,877,560.8516,887,564.8516,883,560.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="883" y="527.6528">фильтрация</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="883" y="542.7856">блокировка изменений</text><polygon fill="#181818" points="1046,585.9844,1056,589.9844,1046,593.9844,1050,589.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="876" x2="1052" y1="589.9844" y2="589.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="883" y="584.9185">фильтрованные данные</text><line style="stroke:#181818;stroke-width:1.0;" x1="1068" x2="1110" y1="664.25" y2="664.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="1110" x2="1110" y1="664.25" y2="677.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="1069" x2="1110" y1="677.25" y2="677.25"/><polygon fill="#181818" points="1079,673.25,1069,677.25,1079,681.25,1075,677.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="1075" y="644.0513">выполнение</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1075" y="659.1841">полезного кода</text><polygon fill="#181818" points="1225,702.3828,1235,706.3828,1225,710.3828,1229,706.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1063" x2="1231" y1="706.3828" y2="706.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1070" y="701.3169">отправка результатов</text><polygon fill="#181818" points="1402,783.9141,1412,787.9141,1402,791.9141,1406,787.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1242" x2="1408" y1="787.9141" y2="787.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="1249" y="737.4497">продюсирование</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="1249" y="752.5825">измененной таблицы</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1249" y="767.7153">table_x.topics</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="1249" y="782.8481">в топик</text><path d="M1346.5,802.9141 L1424.5,802.9141 L1424.5,810.0469 L1414.5,820.0469 L1346.5,820.0469 L1346.5,802.9141 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="193.1953" style="stroke:#000000;stroke-width:1.5;" width="602.5" x="1346.5" y="802.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="1361.5" y="815.981">loop</text><polygon fill="#181818" points="1425,867.4453,1415,871.4453,1425,875.4453,1421,871.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1419" x2="1585" y1="871.4453" y2="871.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="1431" y="836.1138">чтение из топика</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="1431" y="851.2466">обработанных данных</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1431" y="866.3794">таблицы table_x</text><polygon fill="#181818" points="1765,911.7109,1775,915.7109,1765,919.7109,1769,915.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1591" x2="1771" y1="915.7109" y2="915.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="1598" y="895.5122">подготовка обновления</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1598" y="910.645">таблицы table_x</text><line style="stroke:#181818;stroke-width:1.0;" x1="1787" x2="1829" y1="980.1094" y2="980.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1829" x2="1829" y1="980.1094" y2="993.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="1782" x2="1829" y1="993.1094" y2="993.1094"/><polygon fill="#181818" points="1792,989.1094,1782,993.1094,1792,997.1094,1788,993.1094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="1794" y="944.7778">обновление таблицы</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="1794" y="959.9106">table_x</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="1794" y="975.0435">в PostgreSQL</text><!--MD5=[e506c5bfc5d455a0a17f22f248a29de6]
@startuml
hide footbox

title Главный поток выполнения

box "\nSource External System" #BlanchedAlmond
database Source_DB
entity Debezium as Debezium
control SourceKafkaConnect as KafkaConnect
end box

queue Kafka_Topics as inbound_Kafka 

box "\nAirflow System" #LightCyan
control AirflowKafkaConsumer as Consumer
entity FilterOperator as Filter
boundary AirFlowCode as AirFlowCode
control AirflowKafkaProducer as Producer
end box

queue Kafka_Topics as outbound_Kafka

box "\nDestination External System" #Cornsilk
control SinkKafkaConnector      as PG_Sink
database Destination_DB as PG_OLPT
end box
|||
loop 
activate Source_DB
  Source_DB <- Debezium : WAL-репликация CDC
  deactivate Source_DB
  activate Debezium
  Debezium->Debezium: Фильтрация для\nскользящего окна\nна уровне коннектора
  Debezium -> KafkaConnect: фильтрованные записи

  activate KafkaConnect
  KafkaConnect -> inbound_Kafka : table_x.topics
  deactivate KafkaConnect
  deactivate Debezium
|||

inbound_Kafka  <- Consumer : чтения таблиц\ntable_x.topics\nиз топика
group Airflow DAG [запуск DAG Airflow по расписанию]
 
	activate Consumer
	Consumer -> Filter : отправка данных\nна фильтрацию
	deactivate Consumer

	activate Filter
	Filter->Filter : фильтрация\nблокировка изменений
	Filter ->AirFlowCode : фильтрованные данные
	activate AirFlowCode
	deactivate Filter

	AirFlowCode -> AirFlowCode: выполнение\nполезного кода

	AirFlowCode -> Producer : отправка результатов
	deactivate AirFlowCode

	activate Producer
end
	Producer -> outbound_Kafka : продюсирование\nизмененной таблицы\ntable_x.topics\nв топик 
	deactivate Producer


loop
outbound_Kafka <- PG_Sink: чтение из топика\nобработанных данных\nтаблицы table_x
activate PG_Sink
PG_Sink -> PG_OLPT: подготовка обновления\nтаблицы table_x
deactivate PG_Sink

activate PG_OLPT
PG_OLPT->PG_OLPT: обновление таблицы\ntable_x\nв PostgreSQL
deactivate PG_OLPT
end
@enduml

PlantUML version 1.2022.7beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>